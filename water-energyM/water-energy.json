{
  "metadata": {
    "title": "Water Network Integrated pywr-MOEA",
    "description": "Model to test the concept of couple a water-energy simulation model with an expansion planning MOEA model",
    "minimum_version": "0.5"
  },
  "timestepper": {
    "start": "2015-01-01",
    "end": "2015-12-31",
    "timestep": 1
  },
  "scenarios": [
    {
      "name": "weather",
      "size": 10
    }
  ],
  "nodes": [
    {
      "name": "catchment1",
      "type": "catchment",
      "flow": "catchment1_inflow"
    },
    {
      "name": "catchment2",
      "type": "catchment",
      "flow": "catchment2_inflow"
    },
    {
      "name": "catchment3",
      "type": "catchment",
      "flow": "catchment3_inflow"
    },
    {
      "name": "catchment4",
      "type": "catchment",
      "flow": "catchment4_inflow"
    },
    {
      "name": "catchment5",
      "type": "catchment",
      "flow": "catchment5_inflow"
    },
    {
      "name": "river1",
      "type": "river"
    },
    {
      "name": "river2",
      "type": "river"
    },
    {
      "name": "river3",
      "type": "river"
    },
    {
      "name": "river4",
      "type": "river"
    },
    {
      "name": "reservoir1",
      "type": "storage",
      "initial_volume": 200,
      "max_volume": "reservoir1_capacity"
    },
    {
      "name": "reservoir2",
      "type": "storage",
      "initial_volume": 200,
      "max_volume": "reservoir2_capacity"
    },
    {
      "name": "spill1",
      "type": "river",
      "cost": 545
    },
    {
      "name": "spill2",
      "type": "river",
      "cost": 545
    },
    {
      "name": "turbine1",
      "type": "river",
      "max_flow": "turbine1_control"
    },
    {
      "name": "turbine2",
      "type": "river",
      "max_flow": "turbine2_control"
    },
    {
      "name": "irrigation1_channel1",
      "type": "link",
      "max_flow": "channel1_capacity"
    },
    {
      "name": "irrigation1_channel2",
      "type": "link",
      "max_flow": "channel2_capacity"
    },
    {
      "name": "irrigation2_channel3",
      "type": "link",
      "max_flow": "channel3_capacity"
    },
    {
      "name": "water_supply1_channel4",
      "type": "link",
      "max_flow": "channel4_capacity"
    },
    {
      "name": "irrigation1",
      "type": "Output",
      "max_flow": 5,
      "cost": -54500
    },
    {
      "name": "irrigation2",
      "type": "Output",
      "max_flow": 5,
      "cost": -54500
    },
    {
      "name": "water_supply1",
      "type": "Output",
      "max_flow": 5,
      "cost": -54500
    },
    {
      "name": "return_flow1",
      "type": "river"
    },
    {
      "name": "return_flow2",
      "type": "river"
    },
    {
      "name": "term1",
      "type": "output"
    },
    {
      "name": "thermal1",
      "type": "input",
      "cost": 500,
      "max_flow": "thermal1_capacity"
    },
    {
      "name": "thermal2",
      "type": "input",
      "cost": 200,
      "max_flow": "thermal2_capacity"
    },
    {
      "name": "thermal3",
      "type": "input",
      "cost": 500,
      "max_flow": "thermal3_capacity"
    },
    {
      "name": "hydropower_turbine1",
      "type": "input",
      "max_flow": "turbine1_capacity"
    },
    {
      "name": "hydropower_turbine2",
      "type": "input",
      "max_flow": "turbine2_capacity"
    },
    {
      "name": "energy_demand1",
      "type": "output",
      "max_flow": 600,
      "cost": -1000
    },
    {
      "name": "energy_demand2",
      "type": "output",
      "max_flow": 600,
      "cost": -1000
    },
    {
      "name": "bus1",
      "type": "link"
    },
    {
      "name": "bus2",
      "type": "link"
    },
    {
      "name": "transmission_line",
      "type": "link",
      "max_flow": "transmission_capacity"
    },
    {
      "name": "turbine_energy_generation1",
      "type": "aggregatednode",
      "nodes": [
        "turbine1",
        "hydropower_turbine1"
      ],
      "factors": [
        1.0,
        54.5
      ],
      "comment": "Turbine factor = [flow -> m3/s]*[g]*[head]*[density]*[convert -> MWh/day] (1e6 / 3600 / 24) * 9.81 * 20 * 1000 * 24 * (1 / 1e6) = 9.81 * 20 / 3.6 = 54.5"
    },
    {
      "name": "turbine_energy_generation2",
      "type": "aggregatednode",
      "nodes": [
        "turbine2",
        "hydropower_turbine2"
      ],
      "factors": [
        1.0,
        54.5
      ],
      "comment": "Turbine factor = [flow -> m3/s]*[g]*[head]*[density]*[convert -> MWh/day] (1e6 / 3600 / 24) * 9.81 * 20 * 1000 * 24 * (1 / 1e6) = 9.81 * 20 / 3.6 = 54.5"
    }
  ],
  "edges": [
    [
      "catchment1",
      "river1"
    ],
    [
      "river1",
      "irrigation1_channel1"
    ],
    [
      "irrigation1_channel1",
      "irrigation1"
    ],
    [
      "irrigation1",
      "return_flow1"
    ],
    [
      "return_flow1",
      "river2"
    ],
    [
      "river1",
      "river2"
    ],
    [
      "catchment3",
      "river2"
    ],
    [
      "river2",
      "reservoir2"
    ],
    [
      "catchment2",
      "reservoir1"
    ],
    [
      "reservoir1",
      "irrigation1_channel2"
    ],
    [
      "irrigation1_channel2",
      "irrigation1"
    ],
    [
      "reservoir1",
      "spill1"
    ],
    [
      "reservoir1",
      "turbine1"
    ],
    [
      "spill1",
      "river3"
    ],
    [
      "turbine1",
      "river3"
    ],
    [
      "river3",
      "reservoir2"
    ],
    [
      "catchment4",
      "reservoir2"
    ],
    [
      "reservoir2",
      "water_supply1_channel4"
    ],
    [
      "water_supply1_channel4",
      "water_supply1"
    ],
    [
      "reservoir2",
      "turbine2"
    ],
    [
      "turbine2",
      "river4"
    ],
    [
      "reservoir2",
      "irrigation2_channel3"
    ],
    [
      "irrigation2_channel3",
      "irrigation2"
    ],
    [
      "catchment5",
      "irrigation2"
    ],
    [
      "irrigation2",
      "return_flow2"
    ],
    [
      "return_flow2",
      "river4"
    ],
    [
      "reservoir2",
      "spill2"
    ],
    [
      "spill2",
      "river4"
    ],
    [
      "river4",
      "term1"
    ],
    [
      "thermal1",
      "bus1"
    ],
    [
      "hydropower_turbine1",
      "bus1"
    ],
    [
      "thermal3",
      "bus1"
    ],
    [
      "hydropower_turbine2",
      "bus1"
    ],
    [
      "thermal2",
      "bus2"
    ],
    [
      "bus1",
      "transmission_line"
    ],
    [
      "transmission_line",
      "bus1"
    ],
    [
      "transmission_line",
      "bus2"
    ],
    [
      "bus2",
      "transmission_line"
    ],
    [
      "bus1",
      "energy_demand1"
    ],
    [
      "bus2",
      "energy_demand2"
    ]
  ],
  "parameters": {
    "catchment1_inflow": {
      "type": "dataframe",
      "url": "../data/catchmod_flows_by_catchment_sub010.h5",
      "scenario": "weather",
      "key": "catchment1_cntr"
    },
    "catchment2_inflow": {
      "type": "dataframe",
      "url": "../data/catchmod_flows_by_catchment_sub010.h5",
      "scenario": "weather",
      "key": "catchment2_cntr"
    },
    "catchment3_inflow": {
      "type": "dataframe",
      "url": "../data/catchmod_flows_by_catchment_sub010.h5",
      "scenario": "weather",
      "key": "catchment3_cntr"
    },
    "catchment4_inflow": {
      "type": "dataframe",
      "url": "../data/catchmod_flows_by_catchment_sub010.h5",
      "scenario": "weather",
      "key": "catchment4_cntr"
    },
    "catchment5_inflow": {
      "type": "dataframe",
      "url": "../data/catchmod_flows_by_catchment_sub010.h5",
      "scenario": "weather",
      "key": "catchment5_cntr"
    },
    "channel1_capacity": {
      "type": "constant",
      "value": 10,
      "is_variable": true,
      "upper_bounds": 15,
      "lower_bounds": 0
    },
    "channel2_capacity": {
      "type": "constant",
      "value": 10,
      "is_variable": true,
      "upper_bounds": 15,
      "lower_bounds": 0
    },
    "channel3_capacity": {
      "type": "constant",
      "value": 10,
      "is_variable": true,
      "upper_bounds": 15,
      "lower_bounds": 0
    },
    "channel4_capacity": {
      "type": "constant",
      "value": 10,
      "is_variable": true,
      "upper_bounds": 15,
      "lower_bounds": 0
    },
    "reservoir1_capacity": {
      "type": "constant",
      "value": 900,
      "is_variable": true,
      "upper_bounds": 1000,
      "lower_bounds": 0
    },
    "reservoir2_capacity": {
      "type": "constant",
      "value": 600,
      "is_variable": true,
      "upper_bounds": 800,
      "lower_bounds": 0
    },
    "turbine1_control": {
      "type": "controlcurve",
      "storage_node": "reservoir1",
      "control_curve": "turbine_cc1",
      "parameters": [
        "turbine1_above",
        "turbine1_below"
      ]
    },
    "turbine_cc1": {
      "type": "constant",
      "value": 0.5
    },
    "turbine1_above": {
      "type": "constant",
      "value": 1.0,
      "upper_bounds": 2.0,
      "lower_bounds": 0.0,
      "is_variable": true
    },
    "turbine1_below": {
      "type": "constant",
      "value": 0.0
    },
    "turbine2_control": {
      "type": "controlcurve",
      "storage_node": "reservoir2",
      "control_curve": "turbine_cc2",
      "parameters": [
        "turbine2_above",
        "turbine2_below"
      ]
    },
    "turbine_cc2": {
      "type": "constant",
      "value": 0.5
    },
    "turbine2_above": {
      "type": "constant",
      "value": 1.0,
      "upper_bounds": 2.0,
      "lower_bounds": 0.0,
      "is_variable": true
    },
    "turbine2_below": {
      "type": "constant",
      "value": 0.0
    },
    "thermal1_capacity": {
      "type": "constant",
      "value": 500,
      "is_variable": true,
      "upper_bounds": 900,
      "lower_bounds": 0
    },
    "thermal2_capacity": {
      "type": "constant",
      "value": 200,
      "is_variable": true,
      "upper_bounds": 700,
      "lower_bounds": 0
    },
    "thermal3_capacity": {
      "type": "constant",
      "value": 500,
      "is_variable": true,
      "upper_bounds": 800,
      "lower_bounds": 0
    },
    "turbine1_capacity": {
      "type": "constant",
      "value": 500,
      "is_variable": true,
      "upper_bounds": 800,
      "lower_bounds": 0
    },
    "turbine2_capacity": {
      "type": "constant",
      "value": 500,
      "is_variable": true,
      "upper_bounds": 800,
      "lower_bounds": 0
    },
    "transmission_capacity": {
      "type": "constant",
      "value": 900,
      "is_variable": true,
      "upper_bounds": 900,
      "lower_bounds": 0
    }
  },
  "recorders": {
    "irrigation1_deficit_frequency": {
      "type": "deficitfrequencynodeRecorder",
      "node": "irrigation1",
      "is_objective": "minimise"
    },
    "irrigation2_deficit_frequency": {
      "type": "deficitfrequencynodeRecorder",
      "node": "irrigation2",
      "is_objective": "minimise"
    },
    "water_supply_deficit_frequency": {
      "type": "deficitfrequencynodeRecorder",
      "node": "water_supply1",
      "is_objective": "minimise"
    },
    "aggregated_deficit_frequency": {
      "type": "aggregatedrecorder",
      "recorder_agg_func": "mean",
      "recorders": [
        "water_supply_deficit_frequency",
        "irrigation1_deficit_frequency",
        "irrigation2_deficit_frequency"
      ],
      "is_objective": null
    },
    "reservoir1_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "reservoir1_capacity",
      "factor": 2.5
    },
    "reservoir2_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "reservoir2_capacity",
      "factor": 2.5
    },
    "channel1_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "channel1_capacity",
      "factor": 2.5
    },
    "channel2_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "channel2_capacity",
      "factor": 2.5
    },
    "channel3_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "channel3_capacity",
      "factor": 2.5
    },
    "channel4_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "channel4_capacity",
      "factor": 2.5
    },
    "water_total_capex": {
      "type": "aggregated",
      "recorder_agg_func": "sum",
      "recorders": [
        "reservoir1_capex",
        "reservoir2_capex",
        "channel1_capex",
        "channel2_capex",
        "channel3_capex",
        "channel4_capex"
      ],
      "is_objective": "minimise"
    },
    "thermal1_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "thermal1_capacity",
      "factor": 2.5
    },
    "thermal2_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "thermal2_capacity",
      "factor": 2.5
    },
    "thermal3_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "thermal3_capacity",
      "factor": 2.5
    },
    "turbine1_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "turbine1_capacity",
      "factor": 2.5
    },
    "turbine2_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "turbine2_capacity",
      "factor": 2.5
    },
    "transmission_capex": {
      "type": "MeanParameterRecorder",
      "parameter": "transmission_capacity",
      "factor": 2.5
    },
    "energy_total_capex": {
      "type": "aggregated",
      "recorder_agg_func": "sum",
      "recorders": [
        "thermal1_capex",
        "thermal2_capex",
        "thermal3_capex",
        "turbine1_capex",
        "turbine2_capex",
        "transmission_capex"
      ],
      "is_objective": "minimise"
    },
    "thermal1_opex": {
      "type": "TotalFlowNodeRecorder",
      "node": "thermal1",
      "factor": 500
    },
    "thermal2_opex": {
      "type": "TotalFlowNodeRecorder",
      "node": "thermal2",
      "factor": 200
    },
    "thermal3_opex": {
      "type": "TotalFlowNodeRecorder",
      "node": "thermal3",
      "factor": 300
    },
    "energy_total_opex": {
      "type": "aggregated",
      "recorder_agg_func": "sum",
      "recorders": [
        "thermal1_opex",
        "thermal2_opex",
        "thermal3_opex"
      ],
      "is_objective": "minimise"
    },
    "energy1_deficit_frequency": {
      "type": "deficitfrequencynodeRecorder",
      "node": "energy_demand1"
    },
    "energy2_deficit_frequency": {
      "type": "deficitfrequencynodeRecorder",
      "node": "energy_demand2"
    },
    "aggregated_energy_deficit_frequency": {
      "type": "aggregatedrecorder",
      "recorder_agg_func": "sum",
      "recorders": [
        "energy1_deficit_frequency",
        "energy2_deficit_frequency"
      ],
      "is_objective": "minimise"
    }
  }
}